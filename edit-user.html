<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Edit user profile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css" />
    <link rel="stylesheet" href="./static/css/app.css" />
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  </head>
  <body>
    <div id="app" v-cloak>
      <h1 class="title">{{ title }}</h1>
      <user-form v-if="user" v-bind:user="user"></user-form>
    </div>

    <template id="user-profile">
      <div>
        <h2 class="subtitle">{{ user.name }}</h2>
        <form>
          <p>
            Имя:<br />
            <input v-bind:value="user.name" />
          </p>
        </form>
      </div>
    </template>

    <script>
      var UserForm = {
        props: {
          user: {
            type: Object,
            required: true,
          },
        },
        template: '#user-profile',
      };

      var app = new Vue({
        el: '#app',
        components: {
          'user-form': UserForm,
        },
        computed: {},
        data: function() {
          return {
            title: 'Профиль пользователя',
            user: null,
          };
        },
        methods: {},
        mounted: function() {
          var self = this;
          var userId = location.hash.substr(1);

          if (parseInt(userId, 10) > 0) {
            fetch(`https://jsonplaceholder.typicode.com/users/${userId}`)
              .then(function(response) {
                return response.json();
              })
              .then(function(data) {
                self.user = data;
                console.log('Данные загружены');
              });
          }
        },
      });
    </script>
  </body>
</html>
